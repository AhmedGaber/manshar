<header ng-if="article.body" class="article-header" ng-class="{'nocover': !article.cover_url}">
  <!-- Note: Legacy Article Rendering. -->

  <div class="cover-image" manshar-cover url="{{article.cover_url}}">
  </div>
  <div class="dimmer" ng-show="article.cover_url"></div>

  <div class="title tray">
    <span class="reading-time" ng-hide="article.loading"> {{article.reading_time | timeToRead }}
    </span>
    <h1>{{article.title}}</h1>
    <h2>{{article.tagline}}</h2>
  </div>
</header>

<div class="manshar-article">
  <div class="article-container" ng-class="{'new-version': !!article.json_model, 'tray': !article.json_model}">
    <article ng-if="article.body" id="article-body" ng-bind-html="article.body | mansharSanitizer" highlight-code image-zoom>
      <!-- Note: Legacy Article rendering. -->
    </article>

    <div class="title tray"
        ng-if="article.json_model">
      <span class="reading-time" ng-hide="article.loading"> {{article.reading_time | timeToRead }}
      </span>
    </div>

    <article
      ng-if="article.json_model"
      id="article-body"
      article-renderer
        ng-model="article.json_model"
      image-zoom
      highlight-code></article>
    <div style="clear: both;"></div>
    <div anchored-comments
        article="article"
        guid-elements-container-id="article-body"
        guid-attribute="{{article.body ? 'data-guid' : 'name'}}"
        selector="{{article.body ? '.guid-tagged' : 'section [name]'}}"
        class="comments-container">
    </div>

    <div class="article-meta card-list" ng-hide="article.loading">
      <div class="meta-box" ng-show="article.topic">
        <div class="meta-details topic">
          <a class="meta-thumb" ng-href="/categories/{{article.topic.category.id}}">
            <img ng-src="{{article.topic.category.image_thumb_url}}" />
          </a>
          <div class="meta-text">
            <div class="meta-name">
              <a ng-href="/categories/{{article.topic.category.id}}/topics/{{article.topic.id}}">
                <h3>{{article.topic.title}}</h3>
              </a>
            </div>
            <div class="meta-more">
              <a ng-href="/categories/{{article.topic.category.id}}">
                {{article.topic.category.title}}
              </a>
            </div>
          </div>
        </div>
      </div>

      <div class="meta-box">
        <div class="meta-details">
          <a class="meta-thumb" ng-href="/profiles/{{article.user.id}}">
            <img ng-src="{{article.user.thumb_url}}" />
          </a>
          <div class="meta-text">
            <div class="meta-name">
              <a ng-href="/profiles/{{article.user.id}}">
                <h3>{{article.user.name || 'غير معروف'}}</h3>
              </a>
            </div>
            <div class="meta-more">
              {{article.published_at | date:'fullDate'}}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="article-actions" ng-hide="article.loading">
      <button class="action-button recommend-button long-form" recommend-button article="article"
          analytics-on="click"
          analytics-event="click"
          analytics-category="UI"
          analytics-label="Recommend Button in Article Page - {{article.title}}"
          analytics-value="recommend-{{article.id}}">
      </button>
    </div>

    <div ng-include="'views/partials/_sharing_buttons.html'" ng-hide="article.loading">
    </div>
</div>



<div class="next-article-container" ng-show="article.next.id">
  <a href="/articles/{{article.next.id}}">
    <div class="manshar-article-image-container card" manshar-cover url="{{article.next.original_cover_url}}" ng-class="{'manshar-article-nocover': !article.next.original_cover_url}">
      <div class="dimmer" ng-show="article.next.original_cover_url"></div>
      <div class="manshar-article-header tray header">
        <h5>اقرأ أيضاً</h5>
        <span class="reading-time" ng-hide="article.loading"> {{article.next.reading_time | timeToRead }} </span>
        <div class="title">
          <h1>{{article.next.title}}</h1>
          <h2>{{article.next.tagline}}</h2>
        </div>
      </div>
    </div>
  </a>
</div>


<!-- TODO(mkhatib): Disable edits for legacy articles and display a note for
 the owner of the article about the changes. -->
<div class="metabar tray">
  <div class="manshar-controls">
    <button class="action-button"
      ng-click="editArticle(article.id)"
      ng-show="isOwner(user, article)"
      tooltips
        tooltip-class="fixed-tooltip"
        tooltip-title="{{article.body ? 'هذه المقالة قديمة ولا يمكن تعديلها باستخدام المحرر الجديد. يمكنك نسخها ولصقها في مقال جديد إذا أردت التعديل.' : 'تعديل'}}">
      <i class="fa fa-pencil"></i>
    </button>
  </div>
</div>
